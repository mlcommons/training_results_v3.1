# Copyright (c) 2023 Habana Labs, Ltd. an Intel Company
# Copyright (c) Microsoft Corporation.
# SPDX-License-Identifier: Apache-2.0

# DeepSpeed Team

hpu_ci_tests = [
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[None]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_train_schedule_singlestage",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_schedule_firststage",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[3]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[1]",
    "unit/launcher/test_ds_arguments.py::test_no_ds_arguments",
    "unit/launcher/test_ds_arguments.py::test_no_ds_enable_argument",
    "unit/runtime/test_ds_config_model.py::test_config_base",
    "unit/comm/test_dist.py::TestWorldSizeOverrideDistTest::test_world_size_1",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_211",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_122",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[roberta-large-fill-mask-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[bert-base-multilingual-uncased-fill-mask-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[deepset/roberta-base-squad2-question-answering-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[bert-base-uncased-fill-mask-bf16-CG]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[2-2]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_baddim[33-33]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_baddim[0-0]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[1-1]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[32-32]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[5-5]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroAllowUntestedOptimizer::test",
    "unit/runtime/test_ds_config_dict.py::TestInitNoOptimizer::test",
    "unit/runtime/test_ds_config_dict.py::TestDistInit::test", "unit/launcher/test_run.py::test_parser_local",
    "unit/launcher/test_run.py::test_parser_mutual_exclusive",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[WarmupLR-params0]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[OneCycle-params2]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[LRRangeTest-params3]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[WarmupDecayLR-params1]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0.001-100]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[0.001-0.1-0.1-21-21]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0-211]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.1-0-10-0]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[0.001-0.1-0-21-21]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0-210]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0.001-101]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.01-0.001-10-100]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.01-0.001-10-101]",
    "unit/runtime/utils/test_partition.py::test_float_balanced",
    "unit/runtime/utils/test_partition.py::test_int_balanced",
    "unit/runtime/utils/test_partition.py::test_easy_balance_uniform",
    "unit/runtime/utils/test_partition.py::test_float_midheavy",
    "unit/runtime/utils/test_partition.py::test_short_partition_uniform",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings2]",
    "unit/autotuning/test_autotuning.py::test_command_line",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings4]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings3]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[None]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings1]",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_existing_latest",
    "unit/runtime/test_pld.py::TestNonPLDModel::test_non_pld_model",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_deprecatedfields",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_aliasfields",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensor::test_ckpt_non_tensor_output[None]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensor::test_ckpt_non_tensor_input[None]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensorOutputOrdering::test_ckpt_non_tensor_output_ordering[non_tensor_output3]",
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[Optimizer]",
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[optimizer_type2]",
    "unit/elasticity/test_elastic.py::test_proper_mbsz", "unit/runtime/pipe/test_topology.py::test_topology_rank_repr",
    "unit/runtime/pipe/test_topology.py::test_topology_2d", "unit/runtime/pipe/test_topology.py::test_primes",
    "unit/runtime/sparse_tensor/test_csr.py::test_csr_addition_different",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[2]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[12]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[24]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[1]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[bert-base-multilingual-uncased-fill-mask-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[deepset/roberta-base-squad2-question-answering-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[roberta-large-fill-mask-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[bert-base-uncased-fill-mask-bf16-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[gpt2-text-generation-fp16-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[gpt2-text-generation-fp16-noCG]"
]

hpu_promote_tests = [
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-True-False-resulting_optimizer9]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-True-False-resulting_optimizer3]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-True-True-resulting_optimizer13]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-True-False-resulting_optimizer1]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-True-True-resulting_optimizer7]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-True-True-resulting_optimizer5]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-True-True-resulting_optimizer15]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-True-False-resulting_optimizer11]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-False-False-resulting_optimizer2]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-False-False-resulting_optimizer8]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-False-False-resulting_optimizer0]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-False-True-resulting_optimizer14]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-False-True-resulting_optimizer12]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-False-True-resulting_optimizer4]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-False-True-resulting_optimizer6]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-False-False-resulting_optimizer10]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[Adam]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[FusedAdam]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-1]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-1]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-2]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-3]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-2]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-3]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[2]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[1]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[3]",
    "unit/compression/test_compression.py::TestCompression::test_mpu_compress",
    "unit/launcher/test_run.py::test_parser_errors", "unit/launcher/test_run.py::test_num_plus_parser",
    "unit/launcher/test_run.py::test_parser_multinode",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-15]",
    "unit/runtime/pipe/test_topology.py::test_topology_3d",
    "unit/runtime/pipe/test_topology.py::test_topology_comm_list",
    "unit/runtime/test_ds_config_dict.py::test_get_bfloat16_enabled[bfloat16]",
    "unit/runtime/test_ds_config_dict.py::test_get_bfloat16_enabled[bf16]",
    "unit/runtime/test_ds_config_dict.py::TestNoModel::test",
    "unit/runtime/test_ds_config_dict.py::TestDeprecatedDeepScaleConfig::test",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs3[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs2[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs3[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs1_outputs1[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs1[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs1_outputs1[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs1[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_arg_none[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_arg_none[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs2[mask1]",
    "unit/launcher/test_ds_arguments.py::test_core_deepscale_arguments",
    "unit/launcher/test_ds_arguments.py::test_no_ds_arguments_no_ds_parser",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_missing_latest",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-scheduler_type2]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-scheduler_type2]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-scheduler_type2]",
    "unit/runtime/utils/test_partition.py::test_balance_bert",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_offload_configs",
    "unit/runtime/zero/test_zero_config.py::test_zero_offload_optimizer_config_pipeline",
    "unit/runtime/test_pld.py::test_pld_schedule[0]", "unit/runtime/test_pld.py::test_pld_schedule[0.9]",
    "unit/runtime/test_pld.py::test_pld_schedule[1.0]", "unit/runtime/test_pld.py::test_pld_schedule[0.1]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[1.0]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0.9]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0.1]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources3]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources1]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources2]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources0]",
    "unit/elasticity/test_elastic.py::test_basic_10k",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_111",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_121",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict0]",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict1]",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict2]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[3]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[1]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[1]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[3]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[facebook/opt-125m-text-generation-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[dslim/bert-base-NER-token-classification-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[j-hartmann/emotion-english-distilroberta-base-text-classification-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[bert-large-uncased-whole-word-masking-finetuned-squad-question-answering-bf16-CG]",
    "unit/inference/test_model_profiling.py::TestModelProfiling::test[True-False-roberta-base-fill-mask]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[Norod78/hebrew-bad_wiki-gpt_neo-tiny-text-generation-fp16-CG]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroEmptyGrad::test",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_existing_latest",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[roberta-base-fill-mask-fp16-CG]",
    "unit/inference/test_inference.py::TestModelTaskKIFalse::test[Norod78/hebrew-bad_wiki-gpt_neo-tiny-text-generation-fp16-CG]"
]

gpu_ci_tests = [
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[None]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_train_schedule_singlestage",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_schedule_firststage",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[3]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_midstage[1]",
    "unit/launcher/test_ds_arguments.py::test_no_ds_arguments",
    "unit/launcher/test_ds_arguments.py::test_no_ds_enable_argument",
    "unit/runtime/test_ds_config_model.py::test_config_base",
    "unit/comm/test_dist.py::TestWorldSizeOverrideDistTest::test_world_size_1",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_211",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_122",
    "unit/inference/test_inference.py::TestModelTask::test[roberta-large-fill-mask-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[bert-base-multilingual-uncased-fill-mask-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[deepset/roberta-base-squad2-question-answering-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[bert-base-uncased-fill-mask-bf16-CG]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[2-2]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_baddim[33-33]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_baddim[0-0]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[1-1]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[32-32]",
    "unit/runtime/zero/test_zero_tiled.py::test_tiled_init[5-5]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroAllowUntestedOptimizer::test",
    "unit/runtime/test_ds_config_dict.py::TestInitNoOptimizer::test",
    "unit/runtime/test_ds_config_dict.py::TestDistInit::test", "unit/launcher/test_run.py::test_parser_local",
    "unit/launcher/test_run.py::test_parser_mutual_exclusive",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[WarmupLR-params0]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[OneCycle-params2]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[LRRangeTest-params3]",
    "unit/runtime/test_lr_schedulers.py::TestSchedulerOptimizerParity::test[WarmupDecayLR-params1]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0.001-100]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[0.001-0.1-0.1-21-21]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0-211]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.1-0-10-0]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[0.001-0.1-0-21-21]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0-210]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_mom[0.08-0.09-0.001-101]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.01-0.001-10-100]",
    "unit/runtime/test_lr_schedulers.py::TestOneCycle::test_lr[1e-05-0.01-0.001-10-101]",
    "unit/runtime/utils/test_partition.py::test_float_balanced",
    "unit/runtime/utils/test_partition.py::test_int_balanced",
    "unit/runtime/utils/test_partition.py::test_easy_balance_uniform",
    "unit/runtime/utils/test_partition.py::test_float_midheavy",
    "unit/runtime/utils/test_partition.py::test_short_partition_uniform",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings2]",
    "unit/autotuning/test_autotuning.py::test_command_line",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings4]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings3]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[None]",
    "unit/autotuning/test_autotuning.py::test_resource_manager_arg_mappings[arg_mappings1]",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_existing_latest",
    "unit/runtime/test_pld.py::TestNonPLDModel::test_non_pld_model",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_deprecatedfields",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_aliasfields",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensor::test_ckpt_non_tensor_output[None]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensor::test_ckpt_non_tensor_input[None]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestCheckpointNonTensorOutputOrdering::test_ckpt_non_tensor_output_ordering[non_tensor_output3]",
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[Optimizer]",
    "unit/runtime/test_ds_initialize.py::TestClientOptimizer::test[optimizer_type2]",
    "unit/elasticity/test_elastic.py::test_proper_mbsz", "unit/runtime/pipe/test_topology.py::test_topology_rank_repr",
    "unit/runtime/pipe/test_topology.py::test_topology_2d", "unit/runtime/pipe/test_topology.py::test_primes",
    "unit/runtime/sparse_tensor/test_csr.py::test_csr_addition_different",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[2]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[12]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[24]",
    "unit/utils/test_get_optim_files.py::test_get_optim_files[1]",
    "unit/inference/test_inference.py::TestModelTask::test[bert-base-multilingual-uncased-fill-mask-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[deepset/roberta-base-squad2-question-answering-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[roberta-large-fill-mask-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[bert-base-uncased-fill-mask-bf16-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[gpt2-text-generation-fp16-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[gpt2-text-generation-fp16-noCG]"
]

gpu_promote_tests = [
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-True-False-resulting_optimizer9]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-True-False-resulting_optimizer3]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-True-True-resulting_optimizer13]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-True-False-resulting_optimizer1]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-True-True-resulting_optimizer7]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-True-True-resulting_optimizer5]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-True-True-resulting_optimizer15]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-True-False-resulting_optimizer11]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-False-False-resulting_optimizer2]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-False-False-resulting_optimizer8]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-False-False-resulting_optimizer0]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-False-True-resulting_optimizer14]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-False-False-True-resulting_optimizer12]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-False-False-True-resulting_optimizer4]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[AdamW-True-False-True-resulting_optimizer6]",
    "unit/ops/adam/test_adamw.py::TestAdamConfigs::test[Adam-True-False-False-resulting_optimizer10]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[Adam]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroSupportedClientOptimizer::test[FusedAdam]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-1]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-1]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-2]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[Adam-3]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-2]",
    "unit/runtime/half_precision/test_fp16.py::TestZeroSupportedClientOptimizer::test[FusedAdam-3]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[2]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[1]",
    "unit/runtime/zero/test_zero.py::TestZeroUnbalancedGradients::test[3]",
    "unit/compression/test_compression.py::TestCompression::test_mpu_compress",
    "unit/launcher/test_run.py::test_parser_errors", "unit/launcher/test_run.py::test_num_plus_parser",
    "unit/launcher/test_run.py::test_parser_multinode",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-19]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-33]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[log-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-10]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[linear-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_schedule[log-15]",
    "unit/runtime/test_lr_schedulers.py::TestLrSchedule::test_lr_warmup_decay_schedule[linear-15]",
    "unit/runtime/pipe/test_topology.py::test_topology_3d",
    "unit/runtime/pipe/test_topology.py::test_topology_comm_list",
    "unit/runtime/test_ds_config_dict.py::test_get_bfloat16_enabled[bfloat16]",
    "unit/runtime/test_ds_config_dict.py::test_get_bfloat16_enabled[bf16]",
    "unit/runtime/test_ds_config_dict.py::TestNoModel::test",
    "unit/runtime/test_ds_config_dict.py::TestDeprecatedDeepScaleConfig::test",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs3[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs2[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs3[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs1_outputs1[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs1[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs1_outputs1[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs1[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_arg_none[mask0]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_arg_none[mask1]",
    "unit/runtime/activation_checkpointing/test_activation_checkpointing.py::TestActivationCheckpoint::test_ckpt_inputs2_outputs2[mask1]",
    "unit/launcher/test_ds_arguments.py::test_core_deepscale_arguments",
    "unit/launcher/test_ds_arguments.py::test_no_ds_arguments_no_ds_parser",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_missing_latest",
    "unit/compression/test_compression.py::TestCompression::test_conv1d_convertion",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-scheduler_type2]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[optimizer_type2-scheduler_type2]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-_LRScheduler]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[Optimizer-None]",
    "unit/runtime/test_ds_initialize.py::TestClientLrScheduler::test[None-scheduler_type2]",
    "unit/runtime/utils/test_partition.py::test_balance_bert",
    "unit/runtime/zero/test_zero_config.py::test_zero_config_offload_configs",
    "unit/runtime/zero/test_zero_config.py::test_zero_offload_optimizer_config_pipeline",
    "unit/runtime/test_pld.py::test_pld_schedule[0]", "unit/runtime/test_pld.py::test_pld_schedule[0.9]",
    "unit/runtime/test_pld.py::test_pld_schedule[1.0]", "unit/runtime/test_pld.py::test_pld_schedule[0.1]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[1.0]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0.9]",
    "unit/runtime/test_pld.py::TestPLDModel::test_pld_model[0.1]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources3]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources1]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources2]",
    "unit/autotuning/test_autotuning.py::test_autotuner_resources[active_resources0]",
    "unit/elasticity/test_elastic.py::test_basic_10k",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_111",
    "unit/checkpoint/test_reshape_checkpoint.py::test_reshape_222_to_121",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict0]",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict1]",
    "unit/runtime/test_ds_config_model.py::test_config_base_literalfail[config_dict2]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[3]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[10]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[1]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_laststage[8]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[1]",
    "unit/runtime/pipe/test_pipe_schedule.py::test_pipe_inference_schedule_firststage[3]",
    "unit/inference/test_inference.py::TestModelTask::test[facebook/opt-125m-text-generation-fp32-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[dslim/bert-base-NER-token-classification-fp32-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[j-hartmann/emotion-english-distilroberta-base-text-classification-bf16-noCG]",
    "unit/inference/test_inference.py::TestModelTask::test[bert-large-uncased-whole-word-masking-finetuned-squad-question-answering-bf16-CG]",
    "unit/inference/test_model_profiling.py::TestModelProfiling::test[True-False-roberta-base-fill-mask]",
    "unit/inference/test_inference.py::TestModelTask::test[Norod78/hebrew-bad_wiki-gpt_neo-tiny-text-generation-fp16-CG]",
    "unit/runtime/half_precision/test_bf16.py::TestZeroEmptyGrad::test",
    "unit/checkpoint/test_latest_checkpoint.py::TestLatestCheckpoint::test_existing_latest",
    "unit/inference/test_inference.py::TestModelTask::test[roberta-base-fill-mask-fp16-CG]",
    "unit/inference/test_inference.py::TestModelTask::test[Norod78/hebrew-bad_wiki-gpt_neo-tiny-text-generation-fp16-CG]"
]
